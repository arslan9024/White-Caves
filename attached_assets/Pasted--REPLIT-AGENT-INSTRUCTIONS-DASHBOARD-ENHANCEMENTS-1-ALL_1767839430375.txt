# REPLIT AGENT INSTRUCTIONS: DASHBOARD ENHANCEMENTS

## **1. ALL USERS SEE SUB-COMPONENTS (EVEN EMPTY)**

### **Implementation Requirements:**
- Every user role dashboard must render ALL its assigned sub-components
- Empty sub-components should show:
  - Empty state UI (illustration + message)
  - Suggested actions (e.g., "Add your first property")
  - Loading skeleton while fetching data
- Never hide/remove sub-components based on data availability

### **Component Structure:**
```
src/shared/components/dashboard/
â”œâ”€â”€ EmptyState/
â”‚   â”œâ”€â”€ EmptyState.tsx (reusable empty state)
â”‚   â”œâ”€â”€ EmptyStateIllustration.tsx (role-specific illustrations)
â”‚   â””â”€â”€ EmptyStateActions.tsx (suggested actions)
â”œâ”€â”€ LoadingStates/
â”‚   â”œâ”€â”€ SkeletonLoader.tsx
â”‚   â””â”€â”€ ContentPlaceholder.tsx
â””â”€â”€ DashboardContainer.tsx (wrapper with built-in empty states)
```

### **Behavior Rules:**
1. If data loading: Show skeleton
2. If data loaded but empty: Show empty state with role-specific suggestions
3. If data exists: Show data
4. NEVER conditionally render sub-components based on data

## **2. SUB-COMPONENTS WITH INSIDE NAV TABS**

### **Tabbed Sub-Component Architecture:**
```
src/features/[role]/components/
â”œâ”€â”€ [ComponentName]/
â”‚   â”œâ”€â”€ [ComponentName].tsx (main component with tabs)
â”‚   â”œâ”€â”€ tabs/
â”‚   â”‚   â”œâ”€â”€ Tab1.tsx
â”‚   â”‚   â”œâ”€â”€ Tab2.tsx
â”‚   â”‚   â””â”€â”€ Tab3.tsx
â”‚   â”œâ”€â”€ TabNavigation.tsx (internal tab switcher)
â”‚   â””â”€â”€ TabContent.tsx (tab content renderer)
```

### **Requirements:**
- Each sub-component can have its own internal tab navigation
- Tabs should be horizontally scrollable on mobile
- Active tab must be visually distinct
- Tab state should persist in Redux for each user
- URL hash or query params can track active tab

### **Example for Landlord Dashboard:**
```typescript
// LandlordProperties.tsx - Main component with internal tabs
const tabs = [
  { id: 'all', label: 'All Properties', icon: 'ğŸ ' },
  { id: 'active', label: 'Active', icon: 'âœ…' },
  { id: 'vacant', label: 'Vacant', icon: 'ğŸ”„' },
  { id: 'maintenance', label: 'Under Maintenance', icon: 'ğŸ”§' },
  { id: 'archived', label: 'Archived', icon: 'ğŸ“' },
];
```

## **3. ROLE CHANGE REQUEST SYSTEM WITH STATUS UPDATES**

### **Complete Workflow:**
1. **Request Interface:**
   - Dropdown to select desired role
   - Reason text field (optional)
   - Submit button

2. **Redux State Management:**
   ```typescript
   // roleSlice.ts
   interface RoleChangeState {
     pendingRequests: Array<{
       id: string;
       userId: string;
       currentRole: string;
       requestedRole: string;
       reason?: string;
       status: 'pending' | 'approved' | 'rejected';
       requestedAt: string;
       reviewedAt?: string;
       reviewedBy?: string;
     }>;
     userRoleRequest: {
       isRequesting: boolean;
       lastRequestStatus: 'idle' | 'pending' | 'success' | 'error';
       errorMessage: string | null;
     };
   }
   ```

3. **Status Component:**
   ```
   src/shared/components/status/
   â”œâ”€â”€ StatusMessage.tsx (reusable status display)
   â”‚   â”œâ”€â”€ Props: type ('success' | 'error' | 'warning' | 'info' | 'pending')
   â”‚   â”œâ”€â”€ Props: message (string)
   â”‚   â””â”€â”€ Props: autoDismiss (boolean)
   â”œâ”€â”€ SuccessStatus.tsx (green background, check icon)
   â”œâ”€â”€ ErrorStatus.tsx (red background, x icon)
   â”œâ”€â”€ PendingStatus.tsx (yellow/blue background, clock icon)
   â””â”€â”€ StatusHistory.tsx (list of past status updates)
   ```

4. **User Experience Flow:**
   - User submits role change request â†’ shows "Request Submitted (Pending Admin Approval)" in yellow/blue
   - Admin approves â†’ shows "Role Change Approved" in green
   - Admin rejects â†’ shows "Role Change Rejected" in red
   - System error â†’ shows error message in red

5. **Dashboard Integration:**
   - Status component appears at top of user's dashboard
   - Automatically dismisses after 10 seconds (configurable)
   - Click to view full status history
   - Persistent badge on profile icon when pending

## **4. ADDITIONAL REQUIREMENTS MENTIONED**

### **4.1 Owner Dashboard Sub-Menus**
- Remove Services, Inventory, Staff, Clients from main navbar
- Create owner dashboard with these as sub-menu items
- Each sub-menu leads to comprehensive management panels
- Database integration with Redux state synchronization

### **4.2 Leasing Broker Tenancy Contracts**
- When landlord assigns property to leasing broker
- Tenancy contract component appears in BOTH dashboards:
  - Landlord: View contract status
  - Leasing Broker: Edit/manage contract
- Contract workflow states: Draft â†’ Review â†’ Signed â†’ Active â†’ Archived

### **4.3 Universal Profile Component**
- Avatar or dummy image
- Dropdown menu contains:
  - Theme toggle (moved from navbar)
  - Edit profile
  - Settings
  - Role change request link
  - Logout
- When logged out: Acts as sign-in button
- Show role badge with pending requests indicator

## **IMPLEMENTATION PRIORITY ORDER:**

### **Phase 1 (Immediate):**
1. Create EmptyState and LoadingState components
2. Ensure all dashboards render sub-components even when empty
3. Build internal tab navigation for each sub-component

### **Phase 2:**
4. Implement role change request system
5. Create universal StatusMessage component with color coding
6. Integrate status updates into dashboard flow

### **Phase 3:**
7. Move owner features from navbar to owner dashboard
8. Implement tenancy contract sharing between landlord/broker
9. Enhance profile dropdown with all user controls

## **KEY TECHNICAL SPECIFICATIONS:**

### **Responsive Design:**
- Tabs: Horizontal scroll on mobile, fixed width on desktop
- Empty states: Different illustrations for mobile/desktop
- Status messages: Full width on mobile, toast-style on desktop

### **Redux Integration:**
- All tab states stored in Redux per user
- Role change requests persisted in Redux and synced with backend
- Status messages managed through Redux notifications slice

### **Accessibility:**
- Tab navigation: Keyboard arrow key support
- Status messages: ARIA live regions for screen readers
- Color coding: Additional icons for color-blind users

### **Performance:**
- Lazy load tab content
- Virtualize long status histories
- Debounce role change requests

## **TESTING REQUIREMENTS:**

1. **Empty State Testing:**
   - Verify all sub-components show empty states
   - Test loading skeletons
   - Verify suggested actions are role-appropriate

2. **Tab Navigation Testing:**
   - Test tab switching
   - Verify state persistence
   - Test mobile horizontal scrolling

3. **Role Change Flow Testing:**
   - Submit request â†’ see pending status
   - Admin approval â†’ see success status
   - Admin rejection â†’ see error status
   - Network failure â†’ see error with retry

4. **Responsive Testing:**
   - Mobile: Tabs scroll horizontally
   - Desktop: Tabs fixed layout
   - Tablet: Hybrid behavior

## **DELIVERABLES CHECKLIST:**

âœ… All users see assigned sub-components (even empty)  
âœ… Sub-components have internal tab navigation  
âœ… Role change request system implemented  
âœ… Status updates show with color coding (green=success, red=error, pending=special)  
âœ… Owner features moved to owner dashboard only  
âœ… Tenancy contract shared between landlord and leasing broker  
âœ… Profile dropdown includes theme toggle, settings, logout  
âœ… Responsive design for all components  
âœ… Redux state management for all features  
âœ… Accessibility compliance  

**Execution Order:** Follow phases sequentially. Test each phase before proceeding. All existing functionality must remain intact.